{"last_node_id":148,"last_link_id":247,"nodes":[{"id":85,"type":"IO/Dictionary Bus Get","pos":[168.63485311400046,1380.2614549750006],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":6,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":158},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[153],"slot_index":0}],"properties":{"bus_id":"","variable_name":"omni_api_url"}},{"id":90,"type":"IO/Dictionary Bus Get","pos":[168.8952160000004,1226.6970700000006],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":7,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":159},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[160],"slot_index":0}],"properties":{"bus_id":"","variable_name":"user_in"}},{"id":113,"type":"System/Note","pos":[1292,2086],"size":{"0":210,"1":138},"flags":{},"order":0,"mode":0,"properties":{"value":"-main thread\n- outgoing fact/sanity check\n-teacher persona\n-internal monologue\n-lesson loader, preloaded with standard\n-moderator + fact checker\n-test complience monitoring\n-stantd-testing and artifact-capture\n-parent mode/dash\n-artifact search\n-transcript\n- student profiling, history, and demenor\n- multi-child mode\n- live parent monitoring and internet access limits\n"}},{"id":96,"type":"IO/Dictionary Bus Set","pos":[972.8952160000008,1171.6970700000006],"size":{"0":210,"1":122},"flags":{},"order":12,"execution_priority":"6","mode":0,"inputs":[{"name":"bus id","type":"string","link":167},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":168}],"properties":{"bus_id":"","variable_name":"keywords","variable_value":""}},{"id":123,"type":"IO/Dictionary Bus Get","pos":[1324.3344012375942,-918.1932235317178],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":18,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":211},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[203],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_prompt"}},{"id":122,"type":"IO/Dictionary Bus Get","pos":[1321.8869164250941,-1072.0056863847465],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":17,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":200},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[202],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_system_prompt"}},{"id":133,"type":"IO/Dictionary Bus Set","pos":[2882.967999968063,-1067.328849215313],"size":{"0":451.85302734375,"1":122},"flags":{},"order":31,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":227},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":225}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":132,"type":"IO/Dictionary Bus Set","pos":[2882.967999968063,-899.3288492153116],"size":{"0":448.55303955078125,"1":122},"flags":{},"order":32,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":229},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":226}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":126,"type":"IO/Dictionary Bus Set","pos":[2869.967999968063,-713.3288492153118],"size":{"0":468.35302734375,"1":122},"flags":{},"order":30,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":228},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":217}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_reason","variable_value":""}},{"id":130,"type":"Control/Text Output","pos":[2447.5360575852505,-924.2428194301557],"size":{"0":210,"1":78},"flags":{},"order":27,"execution_priority":"11","mode":0,"inputs":[{"name":"text","type":"string","link":221},{"name":"trigger","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[226],"slot_index":0}],"properties":{"text":"false"}},{"id":131,"type":"Control/Text Output","pos":[2451.5360575852505,-1061.242819430157],"size":{"0":210,"1":78},"flags":{},"order":25,"execution_priority":"11","mode":0,"inputs":[{"name":"text","type":"string","link":222},{"name":"trigger","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[225],"slot_index":0}],"properties":{"text":"true"}},{"id":121,"type":"IO/Dictionary Bus Get","pos":[1319.4912493821248,-1241.6942308559376],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":16,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":199},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[213,230],"slot_index":0}],"properties":{"bus_id":"","variable_name":"rules_of_conduct"}},{"id":140,"type":"IO/Dictionary Bus Get","pos":[1973.6283476843753,-675.2875894523432],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":10,"execution_priority":"9","mode":0,"inputs":[{"name":"bus id","type":"string","link":247},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[232],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score_system_prompt"}},{"id":138,"type":"Text/Prefix Text","pos":[1996.6283476843753,-487.2875894523439],"size":{"0":210,"1":58},"flags":{},"order":21,"execution_priority":"9","mode":0,"inputs":[{"name":"in","type":"string","link":230}],"outputs":[{"name":"out","type":"string","links":[233],"slot_index":0}],"properties":{"prefix":"Rules of Conduct: "}},{"id":141,"type":"Text/Concatenate Text","pos":[2360.5807685828104,-624.2190582023444],"size":{"0":210,"1":102},"flags":{},"order":28,"execution_priority":"12","mode":0,"inputs":[{"name":"first","type":"string","link":232},{"name":"last","type":"string","link":233}],"outputs":[{"name":"out","type":"string","links":[234],"slot_index":0}],"properties":{"first":"","last":""}},{"id":117,"type":"IO/Dictionary Bus Get","pos":[1319.0492493821248,-1412.8762308559378],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":15,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":198},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[209],"slot_index":0}],"properties":{"bus_id":"","variable_name":"user_in"}},{"id":116,"type":"IO/Dictionary Bus Get","pos":[1324.3274012375941,-767.8042235317181],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":14,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":197},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[205,206,236],"slot_index":0}],"properties":{"bus_id":"","variable_name":"omni_api_url"}},{"id":124,"type":"IO/Dictionary Bus Get","pos":[1326.3274012375941,-612.8042235317183],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":19,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":212},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[208,237],"slot_index":0}],"properties":{"bus_id":"","variable_name":"llm_model_1"}},{"id":134,"type":"Control/Global Variable Get","pos":[2213.5360575852505,-1448.2428194301567],"size":{"0":210,"1":58},"flags":{},"order":23,"execution_priority":"11","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[227,228,229,240],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}},{"id":89,"type":"Control/Global Variable Get","pos":[-133.36514688599928,1320.2614549750006],"size":{"0":210,"1":58},"flags":{},"order":3,"execution_priority":"3","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[158,159,167,241,243],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}},{"id":148,"type":"Text/Text","pos":[-127.10478399999946,1526.6970700000006],"size":{"0":210,"1":58},"flags":{},"order":4,"execution_priority":"3","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[246],"slot_index":0}],"properties":{"value":" 0"}},{"id":145,"type":"IO/Dictionary Bus Set","pos":[176.8952160000004,1714.6970700000006],"size":{"0":448.55303955078125,"1":122},"flags":{},"order":9,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":241},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":244}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":147,"type":"Text/Text","pos":[-125.1047839999994,1743.6970700000006],"size":{"0":210,"1":58},"flags":{},"order":5,"execution_priority":"3","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[244],"slot_index":0}],"properties":{"value":"false"}},{"id":146,"type":"IO/Dictionary Bus Set","pos":[172,1535],"size":{"0":468.35302734375,"1":122},"flags":{},"order":8,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":243},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":246}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score","variable_value":""}},{"id":86,"type":"Control/Global Variable Set","pos":[-438,1505],"size":{"0":210,"1":78},"flags":{},"order":2,"execution_priority":"2","mode":0,"inputs":[{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":156}],"properties":{"var_name":"bus_id","var_value":""}},{"id":18,"type":"Text/Keyword Extraction","pos":[618,1304],"size":{"0":210,"1":78},"flags":{},"order":11,"execution_priority":"5","mode":0,"inputs":[{"name":"text","type":"string","link":160},{"name":"server url","type":"string","link":153}],"outputs":[{"name":"array out","type":"string","links":[168],"slot_index":0}],"properties":{"last_text":"","last_output":"","server_url":""},"color":"#432","bgcolor":"#653"},{"id":88,"type":"IO/Text Input","pos":[-767,1515],"size":{"0":210,"1":58},"flags":{},"order":1,"execution_priority":"1","mode":0,"outputs":[{"name":"out","type":"string","links":[156],"slot_index":0}],"title":"bus_id","properties":{"text":"bus_1"}},{"id":125,"type":"Text/Prefix Text","pos":[1701.8270862890627,-1134.1071967968753],"size":{"0":210,"1":58},"flags":{},"order":20,"execution_priority":"9","mode":0,"inputs":[{"name":"in","type":"string","link":213}],"outputs":[{"name":"out","type":"string","links":[214],"slot_index":0}],"properties":{"prefix":"Rules of Conduct: "}},{"id":127,"type":"LLM/GPT","pos":[2412.4324985937506,-393.02066183593774],"size":{"0":210,"1":202},"flags":{},"order":29,"execution_priority":"13","mode":0,"inputs":[{"name":"system","type":"string","link":234},{"name":"user","type":"string","link":235},{"name":"server url","type":"string","link":236},{"name":"api key","type":"string","link":null},{"name":"model","type":"string","link":237},{"name":"clear","type":"string","link":null},{"name":"grammars","type":"string","link":238}],"outputs":[{"name":"out","type":"string","links":[239],"slot_index":0},{"name":"buffer","type":"string","links":null}],"properties":{"server_url":"","api_key":"","buffer_length":0,"chat_buffer":[],"model":"gpt-3.5-turbo"}},{"id":142,"type":"Text/Multiline Text","pos":[2059.837291171875,-170.97493468749988],"size":{"0":210,"1":238},"flags":{},"order":24,"execution_priority":"11","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[238],"slot_index":0}],"properties":{"value":"root ::= (\n[1-9]\n)"}},{"id":143,"type":"IO/Dictionary Bus Set","pos":[2876.923581992188,-401.39546183593774],"size":{"0":468.35302734375,"1":122},"flags":{},"order":33,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":240},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":239}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score","variable_value":""}},{"id":120,"type":"Control/Prompt Gate (GPT)","pos":[2028.9235819921882,-1004.3954618359373],"size":{"0":310.1023254394531,"1":178},"flags":{},"order":22,"execution_priority":"10","mode":0,"inputs":[{"name":"in","type":"string","link":209},{"name":"context","type":"string","link":214},{"name":"system","type":"string","link":202},{"name":"prompt","type":"string","link":203},{"name":"server url","type":"string","link":206},{"name":"api key","type":"string","link":205},{"name":"model","type":"string","link":208}],"outputs":[{"name":"yes","type":-1,"links":null},{"name":"no","type":-1,"links":null},{"name":"yes","type":"string","links":[222,231],"slot_index":2},{"name":"no","type":"string","links":[221],"slot_index":3},{"name":"reasoning","type":"string","links":[217],"slot_index":4}],"properties":{"prompt":"Does the user input violate the rules of conduct?","url":"/v1/chat/completions","api_key":"","reasoning":"","last_input":"","model":"gpt-3.5-turbo"}},{"id":136,"type":"Text/Prefix Text","pos":[2070.057225488281,-308.3379232421878],"size":{"0":210,"1":58},"flags":{},"order":26,"execution_priority":"11","mode":0,"inputs":[{"name":"in","type":"string","link":231}],"outputs":[{"name":"out","type":"string","links":[235],"slot_index":0}],"properties":{"prefix":"Violating Text:"}},{"id":115,"type":"Control/Global Variable Get","pos":[863.4912493821246,-1020.6942308559373],"size":{"0":210,"1":58},"flags":{},"order":13,"execution_priority":"7","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[197,198,199,200,211,212,247],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}}],"links":[[153,85,0,18,1,"string"],[156,88,0,86,1,"string"],[158,89,0,85,0,"string"],[159,89,0,90,0,"string"],[160,90,0,18,0,"string"],[167,89,0,96,0,"string"],[168,18,0,96,2,"string"],[197,115,0,116,0,"string"],[198,115,0,117,0,"string"],[199,115,0,121,0,"string"],[200,115,0,122,0,"string"],[202,122,0,120,2,"string"],[203,123,0,120,3,"string"],[205,116,0,120,5,"string"],[206,116,0,120,4,"string"],[208,124,0,120,6,"string"],[209,117,0,120,0,"string"],[211,115,0,123,0,"string"],[212,115,0,124,0,"string"],[213,121,0,125,0,"string"],[214,125,0,120,1,"string"],[217,120,4,126,2,"string"],[221,120,3,130,0,"string"],[222,120,2,131,0,"string"],[225,131,0,133,2,"string"],[226,130,0,132,2,"string"],[227,134,0,133,0,"string"],[228,134,0,126,0,"string"],[229,134,0,132,0,"string"],[230,121,0,138,0,"string"],[231,120,2,136,0,"string"],[232,140,0,141,0,"string"],[233,138,0,141,1,"string"],[234,141,0,127,0,"string"],[235,136,0,127,1,"string"],[236,116,0,127,2,"string"],[237,124,0,127,4,"string"],[238,142,0,127,6,"string"],[239,127,0,143,2,"string"],[240,134,0,143,0,"string"],[241,89,0,145,0,"string"],[243,89,0,146,0,"string"],[244,147,0,145,2,"string"],[246,148,0,146,2,"string"],[247,115,0,140,0,"string"]],"groups":[{"title":"FAQ Extractor","bounding":[5752,1943,234,80],"color":"#3f789e"},{"title":"Event Extractor","bounding":[5780,2186,214,80],"color":"#3f789e"},{"title":"Wiki Manager","bounding":[5941,2339,187,80],"color":"#3f789e"},{"title":"Incoming Moderator","bounding":[781,-1555,3288,1918],"color":"#3f789e"}],"config":{},"extra":{},"version":0.4}