{"last_node_id":151,"last_link_id":260,"nodes":[{"id":85,"type":"IO/Dictionary Bus Get","pos":[168.63485311400046,1380.2614549750006],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":5,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":158},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[153],"slot_index":0}],"properties":{"bus_id":"","variable_name":"omni_api_url"}},{"id":90,"type":"IO/Dictionary Bus Get","pos":[168.8952160000004,1226.6970700000006],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":6,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":159},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[160],"slot_index":0}],"properties":{"bus_id":"","variable_name":"user_in"}},{"id":96,"type":"IO/Dictionary Bus Set","pos":[972.8952160000008,1171.6970700000006],"size":{"0":210,"1":122},"flags":{},"order":10,"execution_priority":"6","mode":0,"inputs":[{"name":"bus id","type":"string","link":167},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":168}],"properties":{"bus_id":"","variable_name":"keywords","variable_value":""}},{"id":123,"type":"IO/Dictionary Bus Get","pos":[1904.2975326384487,1384.1365934606686],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":16,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":211},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[251],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_prompt"}},{"id":122,"type":"IO/Dictionary Bus Get","pos":[1901.8500478259486,1230.3241306076397],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":15,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":200},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[250],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_system_prompt"}},{"id":133,"type":"IO/Dictionary Bus Set","pos":[3462.931131368915,1235.0009677770731],"size":{"0":451.85302734375,"1":122},"flags":{},"order":32,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":227},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":225}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":132,"type":"IO/Dictionary Bus Set","pos":[3462.931131368915,1403.0009677770747],"size":{"0":448.55303955078125,"1":122},"flags":{},"order":33,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":229},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":226}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":126,"type":"IO/Dictionary Bus Set","pos":[3449.931131368915,1589.0009677770745],"size":{"0":468.35302734375,"1":122},"flags":{},"order":31,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":228},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":259}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_reason","variable_value":""}},{"id":121,"type":"IO/Dictionary Bus Get","pos":[1899.454380782979,1060.6355861364489],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":14,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":199},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[213,230],"slot_index":0}],"properties":{"bus_id":"","variable_name":"rules_of_conduct"}},{"id":140,"type":"IO/Dictionary Bus Get","pos":[2553.5914790852294,1627.0422275400429],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":17,"execution_priority":"9","mode":0,"inputs":[{"name":"bus id","type":"string","link":247},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[232],"slot_index":0}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score_system_prompt"}},{"id":138,"type":"Text/Prefix Text","pos":[2576.5914790852294,1815.0422275400422],"size":{"0":210,"1":58},"flags":{},"order":23,"execution_priority":"9","mode":0,"inputs":[{"name":"in","type":"string","link":230}],"outputs":[{"name":"out","type":"string","links":[233],"slot_index":0}],"properties":{"prefix":"Rules of Conduct: "}},{"id":141,"type":"Text/Concatenate Text","pos":[2940.5438999836642,1678.1107587900417],"size":{"0":210,"1":102},"flags":{},"order":29,"execution_priority":"12","mode":0,"inputs":[{"name":"first","type":"string","link":232},{"name":"last","type":"string","link":233}],"outputs":[{"name":"out","type":"string","links":[234],"slot_index":0}],"properties":{"first":"","last":""}},{"id":117,"type":"IO/Dictionary Bus Get","pos":[1899.0123807829789,889.4535861364485],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":13,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":198},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[248],"slot_index":0}],"properties":{"bus_id":"","variable_name":"user_in"}},{"id":116,"type":"IO/Dictionary Bus Get","pos":[1904.2905326384482,1534.5255934606682],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":12,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":197},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[236,252,253],"slot_index":0}],"properties":{"bus_id":"","variable_name":"omni_api_url"}},{"id":124,"type":"IO/Dictionary Bus Get","pos":[1906.2905326384482,1689.5255934606678],"size":{"0":320.0877685546875,"1":102},"flags":{},"order":22,"execution_priority":"8","mode":0,"inputs":[{"name":"bus id","type":"string","link":212},{"name":"var name","type":"string","link":null}],"outputs":[{"name":"text out","type":"string","links":[237,254],"slot_index":0}],"properties":{"bus_id":"","variable_name":"llm_model_1"}},{"id":134,"type":"Control/Global Variable Get","pos":[2793.499188986105,854.0869975622296],"size":{"0":210,"1":58},"flags":{},"order":19,"execution_priority":"11","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[227,228,229,240],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}},{"id":89,"type":"Control/Global Variable Get","pos":[-133.36514688599928,1320.2614549750006],"size":{"0":210,"1":58},"flags":{},"order":2,"execution_priority":"3","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[158,159,167,241,243],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}},{"id":148,"type":"Text/Text","pos":[-127.10478399999946,1526.6970700000006],"size":{"0":210,"1":58},"flags":{},"order":3,"execution_priority":"3","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[246],"slot_index":0}],"properties":{"value":" 0"}},{"id":145,"type":"IO/Dictionary Bus Set","pos":[176.8952160000004,1714.6970700000006],"size":{"0":448.55303955078125,"1":122},"flags":{},"order":8,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":241},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":244}],"properties":{"bus_id":"","variable_name":"incoming_moderator_prompt_gate_is_violation","variable_value":""}},{"id":147,"type":"Text/Text","pos":[-125.1047839999994,1743.6970700000006],"size":{"0":210,"1":58},"flags":{},"order":4,"execution_priority":"3","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[244],"slot_index":0}],"properties":{"value":"false"}},{"id":146,"type":"IO/Dictionary Bus Set","pos":[172,1535],"size":{"0":468.35302734375,"1":122},"flags":{},"order":7,"execution_priority":"4","mode":0,"inputs":[{"name":"bus id","type":"string","link":243},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":246}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score","variable_value":""}},{"id":86,"type":"Control/Global Variable Set","pos":[-438,1505],"size":{"0":210,"1":78},"flags":{},"order":1,"execution_priority":"2","mode":0,"inputs":[{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":156}],"properties":{"var_name":"bus_id","var_value":""}},{"id":18,"type":"Text/Keyword Extraction","pos":[618,1304],"size":{"0":210,"1":78},"flags":{},"order":9,"execution_priority":"5","mode":0,"inputs":[{"name":"text","type":"string","link":160},{"name":"server url","type":"string","link":153}],"outputs":[{"name":"array out","type":"string","links":[168],"slot_index":0}],"properties":{"last_text":"","last_output":"","server_url":""},"color":"#432","bgcolor":"#653"},{"id":88,"type":"IO/Text Input","pos":[-767,1515],"size":{"0":210,"1":58},"flags":{},"order":0,"execution_priority":"1","mode":0,"outputs":[{"name":"out","type":"string","links":[156],"slot_index":0}],"title":"bus_id","properties":{"text":"bus_1"}},{"id":127,"type":"LLM/GPT","pos":[2992.395629994605,1909.3091551564485],"size":{"0":210,"1":202},"flags":{},"order":30,"execution_priority":"13","mode":0,"inputs":[{"name":"system","type":"string","link":234},{"name":"user","type":"string","link":235},{"name":"server url","type":"string","link":236},{"name":"api key","type":"string","link":null},{"name":"model","type":"string","link":237},{"name":"clear","type":"string","link":null},{"name":"grammars","type":"string","link":238}],"outputs":[{"name":"out","type":"string","links":[239],"slot_index":0},{"name":"buffer","type":"string","links":null}],"properties":{"server_url":"","api_key":"","buffer_length":0,"chat_buffer":[],"model":"gpt-3.5-turbo"}},{"id":142,"type":"Text/Multiline Text","pos":[2639.800422572729,2131.354882304886],"size":{"0":210,"1":238},"flags":{},"order":20,"execution_priority":"11","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[238],"slot_index":0}],"properties":{"value":"root ::= (\n[1-9]\n)"}},{"id":143,"type":"IO/Dictionary Bus Set","pos":[3456.88671339304,1900.9343551564484],"size":{"0":468.35302734375,"1":122},"flags":{},"order":34,"execution_priority":"14","mode":0,"inputs":[{"name":"bus id","type":"string","link":240},{"name":"var name","type":"string","link":null},{"name":"var value","type":"string","link":239}],"properties":{"bus_id":"","variable_name":"incoming_moderator_violation_score","variable_value":""}},{"id":136,"type":"Text/Prefix Text","pos":[2650.0203568891347,1993.9918937501984],"size":{"0":210,"1":58},"flags":{},"order":27,"execution_priority":"11","mode":0,"inputs":[{"name":"in","type":"string","link":257}],"outputs":[{"name":"out","type":"string","links":[235],"slot_index":0}],"properties":{"prefix":"Violating Text:"}},{"id":115,"type":"Control/Global Variable Get","pos":[1443.4543807829784,1281.6355861364486],"size":{"0":210,"1":58},"flags":{},"order":11,"execution_priority":"7","mode":0,"inputs":[{"name":"var name","type":"string","link":null}],"outputs":[{"name":"var value","type":"string","links":[197,198,199,200,211,212,247],"slot_index":0}],"properties":{"var_name":"bus_id","var_value":""}},{"id":113,"type":"System/Note","pos":[-904,543],"size":{"0":210,"1":138},"flags":{},"order":21,"mode":0,"properties":{"value":"-main thread\n- outgoing fact/sanity check\n-teacher persona\n-internal monologue\n-lesson loader, preloaded with standard\n-moderator + fact checker\n-test complience monitoring\n-stantd-testing and artifact-capture\n-parent mode/dash\n-artifact search\n-transcript\n- student profiling, history, and demenor\n- multi-child mode\n- live parent monitoring and internet access limits\n"}},{"id":125,"type":"Text/Prefix Text","pos":[2314,1026],"size":{"0":210,"1":58},"flags":{},"order":18,"execution_priority":"9","mode":0,"inputs":[{"name":"in","type":"string","link":213}],"outputs":[{"name":"out","type":"string","links":[249],"slot_index":0}],"properties":{"prefix":"Rules of Conduct: "}},{"id":149,"type":"Control/Prompt Gate (GPT)","pos":[2639,979],"size":{"0":210,"1":198},"flags":{},"order":25,"mode":0,"inputs":[{"name":"in","type":"string","link":248},{"name":"context","type":"string","link":249},{"name":"system","type":"string","link":250},{"name":"prompt","type":"string","link":251},{"name":"server url","type":"string","link":252},{"name":"api key","type":"string","link":253},{"name":"model","type":"string","link":254},{"name":"grammar","type":"string","link":260}],"outputs":[{"name":"yes","type":-1,"links":null},{"name":"no","type":-1,"links":null},{"name":"yes","type":"string","links":[256,257],"slot_index":2},{"name":"no","type":"string","links":[258],"slot_index":3},{"name":"reasoning","type":"string","links":[259],"slot_index":4}],"properties":{"prompt":"","url":"/v1/chat/completions","api_key":"","reasoning":"","last_input":"","model":"gpt-3.5-turbo"}},{"id":131,"type":"Control/Text Output","pos":[3024,1187],"size":{"0":210,"1":78},"flags":{},"order":26,"execution_priority":"11","mode":0,"inputs":[{"name":"text","type":"string","link":256},{"name":"trigger","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[225],"slot_index":0}],"properties":{"text":"true"}},{"id":130,"type":"Control/Text Output","pos":[3026,1337],"size":{"0":210,"1":78},"flags":{},"order":28,"execution_priority":"11","mode":0,"inputs":[{"name":"text","type":"string","link":258},{"name":"trigger","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[226],"slot_index":0}],"properties":{"text":"false"}},{"id":151,"type":"Text/Multiline Text","pos":[2383,1304],"size":{"0":210,"1":238},"flags":{},"order":24,"execution_priority":"11","mode":0,"inputs":[{"name":"in","type":"string","link":null}],"outputs":[{"name":"out","type":"string","links":[260],"slot_index":0}],"properties":{"value":"root ::= object\n\nvalue ::= object | array | string | number | (\"true\" | \"false\" | \"null\") ws\n\nobject ::=\n  \"{\" ws\n    \"\\\"decision\\\"\" \":\" ws item ws \",\" ws\n    \"\\\"reason\\\"\" \":\" ws string ws\n  \"}\" ws\n\nitem ::= \"\\\"item a\\\"\" | \"\\\"item b\\\"\" | \"\\\"item c\\\"\"\n\narray ::=\n  \"[\" ws (\n            value\n    (\",\" ws value)*\n  )? \"]\" ws\n\nstring ::=\n  \"\\\"\" (\n    [^\"\\\\] |\n    \"\\\\\" ([\"\\\\/bfnrt] | \"u\" [0-9a-fA-F] [0-9a-fA-F] [0-9a-fA-F] [0-9a-fA-F]) # escapes\n  )* \"\\\"\" ws\n\nnumber ::= (\"-\"? ([0-9] | [1-9] [0-9]*)) (\".\" [0-9]+)? ([eE] [-+]? [0-9]+)? ws\n\nws ::= ([ \\t\\n\\r]*)\n"}}],"links":[[153,85,0,18,1,"string"],[156,88,0,86,1,"string"],[158,89,0,85,0,"string"],[159,89,0,90,0,"string"],[160,90,0,18,0,"string"],[167,89,0,96,0,"string"],[168,18,0,96,2,"string"],[197,115,0,116,0,"string"],[198,115,0,117,0,"string"],[199,115,0,121,0,"string"],[200,115,0,122,0,"string"],[211,115,0,123,0,"string"],[212,115,0,124,0,"string"],[213,121,0,125,0,"string"],[225,131,0,133,2,"string"],[226,130,0,132,2,"string"],[227,134,0,133,0,"string"],[228,134,0,126,0,"string"],[229,134,0,132,0,"string"],[230,121,0,138,0,"string"],[232,140,0,141,0,"string"],[233,138,0,141,1,"string"],[234,141,0,127,0,"string"],[235,136,0,127,1,"string"],[236,116,0,127,2,"string"],[237,124,0,127,4,"string"],[238,142,0,127,6,"string"],[239,127,0,143,2,"string"],[240,134,0,143,0,"string"],[241,89,0,145,0,"string"],[243,89,0,146,0,"string"],[244,147,0,145,2,"string"],[246,148,0,146,2,"string"],[247,115,0,140,0,"string"],[248,117,0,149,0,"string"],[249,125,0,149,1,"string"],[250,122,0,149,2,"string"],[251,123,0,149,3,"string"],[252,116,0,149,4,"string"],[253,116,0,149,5,"string"],[254,124,0,149,6,"string"],[256,149,2,131,0,"string"],[257,149,2,136,0,"string"],[258,149,3,130,0,"string"],[259,149,4,126,2,"string"],[260,151,0,149,7,"string"]],"groups":[{"title":"FAQ Extractor","bounding":[5752,1943,234,80],"color":"#3f789e"},{"title":"Event Extractor","bounding":[5780,2186,214,80],"color":"#3f789e"},{"title":"Wiki Manager","bounding":[5941,2339,187,80],"color":"#3f789e"},{"title":"Incoming Moderator","bounding":[1361,748,3288,1918],"color":"#3f789e"}],"config":{},"extra":{},"version":0.4}